<!DOCTYPE html>
<html lang="en">
  <head>
    
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>{{restaurant.name}} </title>
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>
    <script src="//code.jquery.com/jquery-1.11.1.min.js"></script>
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700" rel="stylesheet">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios@0.21.4/dist/axios.min.js"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <script src="https://unpkg.com/cart-localstorage@1.1.4/dist/cart-localstorage.min.js" type="text/javascript"></script>
     <link rel="stylesheet" href="https://unpkg.com/swiper@7/swiper-bundle.min.css">
     <link rel="stylesheet" href="/css/style1.css">
     <link rel="stylesheet" href="/css/carousel.css">
  </head>

  <body>
	
	<div class="container-fluid">
		<div class="card">
      <div style="margin-bottom: 15px;
    font-size: 14px;
    color: #0C9463;
    font-weight: 600;
    cursor:pointer" id="go-to-home"><< go to home</div>
			<div class="container-fliud">
				<div class="wrapper row">
					<div class="preview col-md-6" style="max-height:450px;">

            <div
      style="--swiper-navigation-color: #fff; --swiper-pagination-color: #fff"
      class="swiper mySwiper2"
    >
      <div class="swiper-wrapper">
        {{#each restaurant.image}}
        <div class="swiper-slide">
          <img src="{{this}}" />
        </div>
        {{/each}}
      </div>
      <div class="swiper-button-next"></div>
      <div class="swiper-button-prev"></div>
    </div>
    <div thumbsSlider="" class="swiper mySwiper">
      <div class="swiper-wrapper">
        {{#each restaurant.image}}
        <div class="swiper-slide">
          <img src={{this}} />
        </div>
        {{/each}}
      </div>
    </div>
						
					</div>
					<div class="details col-md-6">
						<h2 class="product-title">{{restaurant.name}}</h2>
						<div class="rating">
							<ul class="list-inline stars pl-2" rating={{avgRatings}}>
								<li><i class="fa fa-star"></i></li>
                <li><i class="fa fa-star"></i></li>
                <li><i class="fa fa-star"></i></li>
                <li><i class="fa fa-star"></i></li>
                <li><i class="fa fa-star"></i></li>
							</ul>
							<span class="review-no">{{reviewsCount}} reviews </span>
						</div>
						<p class="product-description">North Indian, Chinese, South Indian, Street Food, Ice Cream, Beverages</p>
            <p class="product-description">{{restaurant.Location.landmark}}, {{restaurant.Location.city}}</p>
            <p class="product-description">{{restaurant.openingTime}} â€“ {{restaurant.closingTime}}</p>
            <p class="product-description">Food will available between above time only</p>
            <div>
							<button class="add-to-cart btn btn-default" type="button" data-toggle="modal" data-target="#myModal"><span class="fa fa-star"></span> Add Reviews</button>
							<button class="like btn btn-default" type="button"><span class="fa fa-heart"></span></button>
			    	</div><br>
        	</div>
		    </div>
	    </div><br>

      <div class="tab">
        <button class="tablinks" onclick="openCity(event, 'Overview')">Overview</button>
        <button class="tablinks" onclick="openCity(event, 'Online Order')">Online Order</button>
        <button class="tablinks" onclick="openCity(event, 'Review')">Review</button>
        <button class="tablinks" onclick="openCity(event, 'Menu')">Menu</button>
        <button class="tablinks" onclick="openCity(event, 'Photos')">Photos</button>
      </div>

      <div id="Overview" class="tabcontent">
        <h3>About this place</h3>
        <p><h4>Name : {{restaurant.name}}</h4></p>
        <p><h5>Address : {{restaurant.address}}, {{restaurant.Location.landmark}}, {{restaurant.Location.city}}, {{restaurant.Location.state}}, {{restaurant.Location.country}}, </h5></p>

        <p><h5>Contact : {{restaurant.contact}}</h5></p>
      </div>


      <div id="Online Order" class="tabcontent">
        <div class="container">
          <h2 class="my-5 text-center" style="font-size: 2.5rem; font-weight: 600;">Menuitems</h2>
          <div class="row mt-4 mb-4 text-center">
            {{#each menuitems}}
            <div class="mb-4 shadow col-12 bg-white" style="border-radius: 10px; padding: 15px;">
              <div class="card-body">
                <div class="row " >
                  <div class="col-2">
                    <div class="img"><img src="https://cdn.pixabay.com/photo/2014/11/05/15/57/salmon-518032__480.jpg" class="img-fluid border-secondary" alt="..."></div>
                  </div>
                  <div class="col-8">
                    <h4 class="card-title pricing-card-title text-left" style="font-size: 2rem; font-weight: 600;" >{{this.name}}</h4>
                    <h5 class="card-title pricing-card-title text-left" style="font-size: 1.5rem;" >&#8377; {{this.price}}</h5>
                    <p class="text-left" style="font-size: 1.2rem;">{{this.description}}</p>
                  </div>
                  <div class="col-2 d-flex align-items-center justify-content-end">
                    <button type="button" class="btn p-3 btn-green" onClick="cartLS.add({id: {{this.id}}, name: '{{this.name}}', price:{{this.price}},})">Add to Cart</button>
                  </div>
                </div>
              </div>
            </div>
            {{/each}}
          </div>
          <div class="card mb-4 shadow-sm">
            <div class="card-header">
              <h2 style="font-size: 2rem; font-weight: 600;">Cart</h2>
            </div>
            <div class="card-body">
              <table class="table cart-table">
                <tbody class="cart"></tbody>
                <tfoot>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td class="text-right">Total: <strong class="total"></strong></td>
                  <td class="text-right"><button class="btn btn-green" id="order-btn">Order</button></td>
                </tfoot>
              </table>
            </div>
          </div>
        </div>
      </div>

      <div id="Review" class="tabcontent">
        <section id="testimonials">
          <div class="testimonial-heading">
            <span>Reviews</span>
            <h1>Customers Says</h1>
          </div>
          <div class="testimonial-box-container">
            {{#each reviews}}
              <div class="testimonial-box">
                <div class="box-top">
                    <div class="profile">
                        <div class="profile-img">
                            <img src="data:image/jpeg;base64,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" alt="profile"/>
                        </div>
                        <div class="name-user">
                            <strong>John Cena</strong>
                        </div>
                    </div>
                    <ul class="list-inline reviews" rating={{this.stars}}>
                        <li><i class="fa fa-star"></i></li>
                        <li><i class="fa fa-star"></i></li>
                        <li><i class="fa fa-star"></i></li>
                        <li><i class="fa fa-star"></i></li>
                        <li><i class="fa fa-star"></i></li>
                    </ul>
                </div>
                <div class="client-comment">
                    <p>{{this.comment}}</p>
                </div>
              </div>
            {{/each}}      
          </div>
        </section>
      </div>
      <div id="Menu" class="tabcontent">
        <h3></h3>
        <p></p>
      </div>
      <div id="Photos" class="tabcontent">
        <h3></h3>
        <p></p>
      </div>
    </div>
  </div>

<!-- The Modal -->
<div class="modal" id="myModal">
  <div class="modal-dialog">
    <div class="modal-content">

      <!-- Modal Header -->
      <div class="modal-header">
        <h4 class="modal-title" style="font-size: 2.5rem;">Review</h4>
      </div>

      <!-- Modal body -->
      <div class="modal-body">
         <h2 id="fh2">WE APPRECIATE YOUR REVIEW!</h2>
<h6 id="fh6">Your review will help us to improve our web hosting quality products, and customer services.</h6>


<form id="feedback"  action="">

 <div class="pinfo">Rate our overall services.</div>
  
<div class="form-group">
  <div class="inputGroupContainer" style="width: 100%;">
  <div class="input-group">
  <span class="input-group-addon" style="font-size : 14px"><i class="fa fa-star"></i></span>
   <select class="form-control" id="rate" name="stars">
      <option value="1star">1</option>
      <option value="2stars">2</option>
      <option value="3stars">3</option>
      <option value="4stars">4</option>
      <option value="5stars">5</option>
    </select>
    </div>
  </div>
</div>

 <div class="pinfo" style="margin-top: 20px;">Write your feedback.</div>
  
<div class="form-group">
  <div class="inputGroupContainer" style="width: 100%;">
  <div class="input-group">
  <span class="input-group-addon" style="height: 70px; font-size : 14px"><i class="fa fa-pencil"></i></span>
  <textarea class="form-control" style="height: 70px;" id="review" rows="3" name="comment"></textarea>
 
    </div>
  </div>
</div>

 <div class="w-100 text-center mt-5">
   <button type="submit" class="btn btn-green" id="btn-submit" data-dismiss="modal" style="margin:10px auto;margin-top: 30px;
    width: 80px;
    height: 30px;
    font-size: 12px;">Submit</button>
 </div>

</form>
      </div>

      <!-- Modal footer -->
      <div class="modal-footer">
        <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
      </div>

    </div>
  </div>
</div>
<script src="https://unpkg.com/swiper@7/swiper-bundle.min.js"></script>
<script>
  let port = window.location.port ? ':'+window.location.port: '';
  let baseUrl = `${window.location.protocol}//${window.location.hostname}${port}`;

  const queryString = window.location.search;
  console.log(queryString);
  const urlParams = new URLSearchParams(queryString);
  console.log(urlParams);
  const restaurantId = urlParams.get('restaurantId');
  console.log(restaurantId);

  function renderCart(items) {
const $cart = document.querySelector(".cart")
const $total = document.querySelector(".total")

 $cart.innerHTML = items.map((item) => `
<tr>
<td>#${item.id}</td>
<td>${item.name}</td>
<td>${item.quantity}</td>
<td style="width: 60px;">
<button type="button" class="btn btn-block btn-sm btn-outline-success" style="font-size:14px; font-weight:600;"
onClick="cartLS.quantity(${item.id},1)">+</button>
</td>
<td style="width: 60px;">
<button type="button" class="btn btn-block btn-sm btn-outline-success" style="font-size:14px; font-weight:600;"
onClick="cartLS.quantity(${item.id},-1)">-</button>
</td>
<td class="text-right">&#8377; ${item.price}</td>
<td class="text-right"><Button class="btn btn-outline-danger" onClick="cartLS.remove(${item.id})">Delete</Button></td>
</tr>`).join("")

 $total.innerHTML = "&#8377; " + cartLS.total()
}
renderCart(cartLS.list())
cartLS.onChange(renderCart)


// go to home page
  document.getElementById('go-to-home').onclick = function(e){
    let url = `${baseUrl}/api/v1`;
    window.location = url;
  }

  document.getElementById('btn-submit').onclick = function(e){
                e.preventDefault();
                const form = document.getElementById('feedback');
                
                // getting the element's value
                const stars = form.elements['rate'].value;
                const comment = form.elements['review'].value;

                const data = {
                  stars : parseInt(stars),
                  comment : comment
                }

                axios.post(
                  `${baseUrl}/api/v1/addnewreview?userId=2&restaurantId=${restaurantId}`,
                   data,
                ).then(res => {
                  console.log(res)
                    alert("Your Review has been successfully submitted.");
                })
                .catch(err => {
                  alert(err.response.data.error)
                })
              }

document.getElementById('order-btn').onclick = function(e){
                e.preventDefault();
                
                let data = JSON.parse(localStorage.getItem('__cart'))
                console.log(data)

                let items = []
            
                data.map(item => {
                  let itm = {menuitemId:item.id,quantity:item.quantity}
                  items.push(itm)
                })
                console.log(items)
   
              if(items.length > 0){
                axios.post(
                  `${baseUrl}/api/v1/order?userId=2&restaurantId=${restaurantId}`,
                   {items},
                ).then(res => {
                  console.log(res)
                  let totalPrice = res.data.orderDetails.total;
                  localStorage.setItem('updatedTotal',totalPrice)
                  //console.log(totalPrice)
                  let orderId = res.data.orderDetails.orderId;
                  //console.log(orderId)
                  let gst = res.data.orderDetails.gst;
                  //console.log(gst)
                  let deliveryCharges = res.data.orderDetails.deliveryCharges;
                  let subtotal = totalPrice - gst - deliveryCharges ;
                  //console.log(subtotal)
                  if(res){
                    let url = `${baseUrl}/api/v1/payment/checkout?userId=2&orderId=${orderId}&totalPrice=${totalPrice}&gst=${gst}&subtotal=${subtotal}&deliveryCharges=${deliveryCharges}&restaurantId=${restaurantId}`;
                    window.location = url;
                  }
                })
                .catch(err => {
                  console.log(err.response.data);
                })
              }else{
                alert('Please Select food items to proceed')
              }
              }

function openCity(evt, cityName) {
  var i, tabcontent, tablinks;
  tabcontent = document.getElementsByClassName("tabcontent");
  for (i = 0; i < tabcontent.length; i++) {
    tabcontent[i].style.display = "none";
  }
  tablinks = document.getElementsByClassName("tablinks");
  for (i = 0; i < tablinks.length; i++) {
    tablinks[i].className = tablinks[i].className.replace(" active", "");
  }
  document.getElementById(cityName).style.display = "block";
  evt.currentTarget.className += " active";
}

var swiper = new Swiper(".mySwiper", {
        loop: true,
        spaceBetween: 10,
        slidesPerView: 6,
        freeMode: true,
        watchSlidesProgress: true,
        });
      var swiper2 = new Swiper(".mySwiper2", {
        loop: true,
        spaceBetween: 10,
        // autoplay: {
        //   delay: 2500,
        //   disableOnInteraction: false,
        // },
        navigation: {
        nextEl: ".swiper-button-next",
        prevEl: ".swiper-button-prev",
        },
        thumbs: {
        swiper: swiper,
        },
    });


</script>
  </body>
</html>
