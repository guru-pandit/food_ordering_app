<!DOCTYPE html>
<html lang="en">
  <head>
    
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>{{restaurant.name}} </title>
    {{!-- <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css"> --}}
    {{!-- <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/js/bootstrap.min.js"></script> --}}
    {{!-- <script src="//code.jquery.com/jquery-1.11.1.min.js"></script> --}}
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    {{!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous"> --}}
    {{!-- <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700" rel="stylesheet"> --}}
    {{!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css"> --}}
    {{!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script> --}}
    {{!-- <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script> --}}
    {{!-- <script src="https://cdn.jsdelivr.net/npm/axios@0.21.4/dist/axios.min.js"></script> --}}
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    {{!-- <script src="https://unpkg.com/cart-localstorage@1.1.4/dist/cart-localstorage.min.js" type="text/javascript"></script> --}}
     {{!-- <link rel="stylesheet" href="/css/style1.css"> --}}
     <link rel="stylesheet" href="/css/style.css">
     <link rel="stylesheet" href="https://unpkg.com/swiper@7/swiper-bundle.min.css">
     <link rel="stylesheet" href="/css/details.css">
     <link rel="stylesheet" href="/css/modals.css">
     <link rel="stylesheet" href="/css/carousel.css">
  </head>

  <body>
	
	<div class="container-fluid details-container">
		<div class="card">
      <a href="/" class="go-to-home" id="go-to-home"><i class="fa fa-arrow-left"></i> Go to home</a>
      <div class="container-fliud">
				        <div class="wrapper row">
				            <div class="preview col-md-6" style="max-height:450px;">
                        <div style="--swiper-navigation-color: #fff; --swiper-pagination-color: #fff" class="swiper mySwiper2">
                            <div class="swiper-wrapper">
                              {{#each restaurant.image}}
                                  <div class="swiper-slide">
                                    <img src="{{this}}" />
                                  </div>
                              {{/each}}
                            </div>
                            <div class="swiper-button-next"></div>
                            <div class="swiper-button-prev"></div>
                        </div>
                        <div thumbsSlider="" class="swiper mySwiper">
                            <div class="swiper-wrapper">
                                {{#each restaurant.image}}
                                    <div class="swiper-slide">
                                      <img src={{this}} />
                                    </div>
                                {{/each}}
                            </div>
                        </div>
					          </div>
                    <div class="details col-md-6">
						            <h2 class="product-title mb-2">{{restaurant.name}}</h2>
						            <div class="rating">
                            <ul class="list-inline stars mb-0" rating={{avgRatings}}>
                                <li><i class="fa fa-star p-0"></i></li>
                                <li><i class="fa fa-star p-0"></i></li>
                                <li><i class="fa fa-star p-0"></i></li>
                                <li><i class="fa fa-star p-0"></i></li>
                                <li><i class="fa fa-star p-0"></i></li>
                            </ul>
							              <span class="review-no mb-2">{{reviewsCount}} reviews </span>
						            </div>
                        <p class="product-description mb-2">North Indian, Chinese, South Indian, Street Food, Ice Cream, Beverages</p>
                        <p class="product-description mb-2">{{restaurant.Location.landmark}}, {{restaurant.Location.City.name}}</p>
                        <p class="product-description mb-2">{{restaurant.openingTime}} â€“ {{restaurant.closingTime}}</p>
                        <p class="product-description mb-3">Food will available between above time only</p>
                        <div>
                          <button class="btn btn-green add-to-cart" type="button" data-toggle="modal" data-target="#myModal"><span class="fa fa-star"></span> Add Reviews</button>
                          <button class="btn btn-outlined-green like" type="button"><span class="fa fa-heart"></span></button>
			    	            </div><br>
        	          </div>
		            </div>
	          </div><br>

      <div class="tab">
        <button class="tablinks" onclick="openCity(event, 'Overview')">Overview</button>
        <button class="tablinks" onclick="openCity(event, 'Online-Order')">Online Order</button>
        <button class="tablinks" onclick="openCity(event, 'Review')">Review</button>
        <button class="tablinks" onclick="openCity(event, 'Menu')">Menu</button>
        <button class="tablinks" onclick="openCity(event, 'Photos')">Photos</button>
      </div>

    
      {{!-- Overview tab --}}
          <div id="Overview" class="tabcontent">
              <h4>About this place</h4>
              <p class="mb-0">Name : {{restaurant.name}}</p>
              <p class="mb-0">Address : {{restaurant.address}}, {{restaurant.Location.landmark}}, {{restaurant.Location.City.name}}, {{restaurant.Location.City.State.name}}, {{restaurant.Location.City.State.Country.name}} </p>
              <p class="mb-0">Contact : {{restaurant.contact}}</p>
          </div>

      {{!-- Order tab --}}
      <div id="Online-Order" class="tabcontent">
          <div class="container details-menu-container">
              {{!-- <h2 class="heading">Menuitems</h2> --}}
                    <div class="row my-2 text-center">
                        {{#each menuitems}}
                            <div class="shadow-sm col-12 details-menucard">
                                <div class="card-body">
                                    <div class="row " >
                                        <div class="col-2">
                                            {{!-- <div class="img"><img src="https://cdn.pixabay.com/photo/2014/11/05/15/57/salmon-518032__480.jpg" class="img-fluid border-secondary" alt="..."></div> --}}
                                            <div class="img"><img src="{{this.image.images.[0]}}" class="img-fluid border-secondary" alt="..."></div>
                                        </div>
                                        <div class="col-8">
                                            <h4 class="card-title pricing-card-title text-left">{{this.name}}</h4>
                                            <h5 class="card-price pricing-card-title text-left">&#8377; {{this.price}}</h5>
                                            <p class="card-desc text-left">{{this.description}}</p>
                                        </div>
                                        <div class="col-2 d-flex align-items-center justify-content-end">
                                          <button type="button" class="btn btn-green" onClick="cartLS.add({id: {{this.id}}, name: '{{this.name}}', price:{{this.price}},})">Add to Cart</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        {{/each}}
                    </div>
                    <div class="card mb-4 shadow-sm" style="display: none;">
                      <div class="card-header">
                        <h2 style="font-size: 2rem; font-weight: 600;">Cart</h2>
                      </div>
                      <div class="card-body">
                        <table class="table cart-table">
                          <tbody class="cart"></tbody>
                          <tfoot>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td class="text-right">Total: <strong class="total"></strong></td>
                            <td class="text-right"><button class="btn btn-green" id="order-btn">Order</button></td>
                          </tfoot>
                        </table>
                      </div>
                    </div>
                </div>

                {{!-- Cart Toggler --}}
                <div class="cart-toggler" id="cart-toggler">
                    <div class="order-details">
                        <div class="order-content" id="order-content">
                            <h2 class="order-details-heading">Your orders</h2>
                            <div class="order-items"  id="order-items"></div>
                        </div>
                    </div>
                    <div class="cart-toggler-main">
                        <span class="cart-toggle-btn" id="cart-toggle-btn"><i class="fa fa-caret-up"></i></span>
                        <h2 class="cart-toggler-heading" id="cart-toggler-heading"></h2>
                        <div style="flex: 1;"></div>
                        <h3 class="cart-toggler-subtotal" id="cart-subtotal"></h3>
                        <button class="btn btn-outlined-green px-4 ml-2" id="clear-cart" onclick="cartLS.destroy()">Clear cart</button>
                        <button class="btn btn-green px-4 ml-2" id="continue" onclick="openPaymentModal()">Continue</button>
                    </div>
                </div>
            </div>

            {{!-- Reviews tab --}}
            <div id="Review" class="tabcontent">
                <section id="testimonials">
                    <div class="testimonial-heading">
                        <span>Reviews</span>
                        <h1>Customers Says</h1>
                    </div>
                    <div class="testimonial-box-container">
                        {{#each reviews}}
                            <div class="testimonial-box">
                                <div class="box-top">
                                    <div class="profile">
                                        <div class="profile-img">
                                            <img src="data:image/jpeg;base64,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" alt="profile"/>
                                        </div>
                                        <div class="name-user">
                                            <strong>John Cena</strong>
                                        </div>
                                    </div>
                                    <ul class="list-inline reviews" rating={{this.stars}}>
                                        <li><i class="fa fa-star"></i></li>
                                        <li><i class="fa fa-star"></i></li>
                                        <li><i class="fa fa-star"></i></li>
                                        <li><i class="fa fa-star"></i></li>
                                        <li><i class="fa fa-star"></i></li>
                                    </ul>
                                </div>
                                <div class="client-comment">
                                    <p>{{this.comment}}</p>
                                </div>
                            </div>
                        {{/each}}      
                    </div>
                </section>
            </div>

            {{!-- menu tab --}}
            <div id="Menu" class="tabcontent">
              <h3></h3>
              <p></p>
            </div>

            {{!-- Photos tab --}}
            <div id="Photos" class="tabcontent">
              <h3></h3>
              <p></p>
            </div>
        </div>
    </div>

    <!-- Review The Modal -->
    <div class="modal" id="myModal">
        <div class="modal-dialog">
            <div class="modal-content">
            <!-- Modal Header -->
            <div class="modal-header">
              <h4 class="modal-title" style="font-size: 2.5rem;">Review</h4>
            </div>
            <!-- Modal body -->
            <div class="modal-body">
                <h2 id="fh2">WE APPRECIATE YOUR REVIEW!</h2>
                <h6 id="fh6">Your review will help us to improve our web hosting quality products, and customer services.</h6>
              <form id="feedback"  action="">
              <div class="pinfo">Rate our overall services.</div>
              <div class="form-group">
                  <div class="inputGroupContainer" style="width: 100%;">
                      <div class="input-group">
                          <span class="input-group-addon" style="font-size : 14px"><i class="fa fa-star"></i></span>
                          <select class="form-control" id="rate" name="stars">
                              <option value="1star">1</option>
                              <option value="2stars">2</option>
                              <option value="3stars">3</option>
                              <option value="4stars">4</option>
                              <option value="5stars">5</option>
                          </select>
                      </div>
                  </div>
              </div>
              <div class="pinfo" style="margin-top: 20px;">Write your feedback.</div>
              <div class="form-group">
                  <div class="inputGroupContainer" style="width: 100%;">
                      <div class="input-group">
                          <span class="input-group-addon" style="height: 70px; font-size : 14px"><i class="fa fa-pencil"></i></span>
                          <textarea class="form-control" style="height: 70px;" id="review" rows="3" name="comment"></textarea>
                      </div>
                  </div>
              </div>
              <div class="w-100 text-center mt-5">
                  <button type="submit" class="btn btn-green" id="btn-submit" data-dismiss="modal" style="margin:10px auto;margin-top: 30px; width: 80px; height: 30px; font-size: 12px;">Submit</button>
              </div>
          </form>
      </div>
      <!-- Modal footer -->
      <div class="modal-footer">
        <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
      </div>

    </div>
  </div>
</div>

{{!-- checkout Modal --}}
<div class="payment-page" id="payment-page">
  <div class="payment-page-content">
    <span class="go-to-rest" id="go-to-rest" onclick="closePaymentModal()"><i class="fa fa-arrow-left"></i> Back to Restaurant</span>
    <div class="row payment-content">
      <div class="col-7 p-0 payment-address">
        <h2 class="payment-heading">Checkout</h2>
        <div class="delivery-address">
          <h3 class="delivery-address-heading" >Delivery address</h3>
          <div class="addresses" id="addresses"> </div>
          <textarea name="" id="address-text" class="address-text"></textarea>
          <div class="add-new-address" onclick="addDeliveryAddress()"><i class="fa fa-plus"></i>  Add new address</div>
        </div>
        <div class="payment-methods">
          <h3 class="payment-method-heading">Select payment method:</h3>
          <div class="payment-method-radio">
              <div class="radio-item">
                  <input type="radio" id="pay_online" name="payment_mode" value="online">
                  <label for="pay_online">Pay online</label>
              </div>

              <div class="radio-item">
                  <input type="radio" id="cash_on_delivery" name="payment_mode" value="cod">
                  <label for="cash_on_delivery">Cash on delivery</label>
              </div>
          </div>
        </div>
      </div>
      <div class="col-5 p-0 order-summary">
        <h3 class="order-summary-heading" >Summary</h3>
        <div class="order-from">
          <p class="order-from-heading">Order from</p>
          <p class="order-from-rest">Royal baithak</p>
        </div>
        <div class="order-itms" id="checkout-items"></div>
        <div class="payment-details">
            <ul class="payment-list-wrapper">
                <li class="payment-list-item">
                    <span>Subtotal </span>
                    <span id="checkout-total"></span>
                </li>
                <li class="payment-list-item">
                    <span>Discount </span>
                    <span id="discount"></span>
                </li>
                <li class="payment-list-item">
                    <span>GST </span>
                    <span id="gst"></span>
                </li>
                <li class="payment-list-item">
                    <span>Delivery Charges</span>
                    <span id="delivery"></span>
                </li>
            </ul>
            <div class="payment-total-wrapper">
                <h3>Grand Total</h3> <span id="grandtotal"></span>
            </div>
        </div>
        <div class="order-for">
          <p class="order-for-heading">Ordering for</p>
          <p class="order-for-rest">Guru Pandit, 7776088638</p>
        </div>

       <button class="place-order btn btn-green" id="place-order" onclick="placeOrder()">Place order</button>
      </div>
    </div>
  </div>
  <!-- The Modal -->
	<div id="dialog-modal" class="dialog-modal">
		<!-- Modal content -->
	</div>
</div>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/axios@0.21.4/dist/axios.min.js"></script>
<script src="https://unpkg.com/cart-localstorage@1.1.4/dist/cart-localstorage.min.js" type="text/javascript"></script>
<script src="https://unpkg.com/swiper@7/swiper-bundle.min.js"></script>
<script src="https://checkout.razorpay.com/v1/checkout.js"></script>
<script src="/js/modal.js"></script>
<script>
    let port = window.location.port ? ':'+window.location.port: '';
    let baseUrl = `${window.location.protocol}//${window.location.hostname}${port}`;
    let deliveryAddress=[]
    let selectedAddress = ""
    let selectedPaymentMode = ""
    let orderDetails={}

    let options={}

    const queryString = window.location.search;
    console.log(queryString);
    const urlParams = new URLSearchParams(queryString);
    console.log(urlParams);
    const restaurantId = urlParams.get('restaurantId');
    console.log(restaurantId);

// Open payment modal
function openPaymentModal() {
  $("#payment-page").addClass("active")
}

// Close payment modal
function closePaymentModal() {
  $("#payment-page").removeClass("active")
}
    
// Toggle cart
$("#cart-toggle-btn").click((e)=>{
  // console.log(e)
  $("#order-content").toggleClass("active")
  $("#clear-cart").toggleClass("active")
})

function renderAddresses(adrs){
  let addresses = document.querySelector("#addresses")
  addresses.innerHTML = adrs.map((adr)=>`<div class="radio-item">
                          <input type="radio" id="${adr}" name="delAdrs" value="${adr}">
                          <label for="${adr}">${adr}</label>
                        </div>`).join("")
}

function setDeliveryAddress(){
  selectedAddress = $("input[name='delAdrs']:checked").val()
  console.log("selectedAddress:",selectedAddress)
}

function setPaymentMode(){
  selectedPaymentMode = $("input[name='payment_mode']:checked").val()
  console.log("selectedPaymentMode:",selectedPaymentMode)
}

//set Delivery address
function addDeliveryAddress(){
    deliveryAddress.push($("#address-text").val())
    console.log(deliveryAddress)
    $("#delivery-address-text").innerHTML = deliveryAddress;
    renderAddresses(deliveryAddress)
}

//Calculate amounts
function calculateAmounts(){
  setDeliveryAddress();
  setPaymentMode()
  const gst = 5;
  const deliveryCharges = 40;
  const discount = 20;

  let orderItems=[]
  orderItems = JSON.parse(localStorage.getItem("__cart"))===null?[]:JSON.parse(localStorage.getItem("__cart"))
  console.log(orderItems)

  let totalItemPrice = 0;
  orderItems.map(({ price, quantity })=>{
      totalItemPrice += price * quantity
  })
  console.log("totalItemPrice: ",totalItemPrice)

  let discountedPrice = totalItemPrice - discount
  console.log("discountedPrice: ",discountedPrice)

  let delCharge = discountedPrice < 1000 ? deliveryCharges : 0
  console.log("delCharge: ",delCharge)

  let gstValue = discountedPrice * 5 / 100
  console.log("gstValue: ",gstValue)
  
  let grandTotal = discountedPrice + gstValue + delCharge
  console.log("grandTotal: ",grandTotal)

  return { gst, delCharge, totalItemPrice, discount, discountedPrice, gstValue, grandTotal }
}


// Function to place order
function placeOrder(){
  let {gst, delCharge, totalItemPrice, discount, discountedPrice, gstValue, grandTotal} = calculateAmounts()

  let data = JSON.parse(localStorage.getItem('__cart'))
  console.log("CartData:Localstorage:", data)
  let selectedItems =[]
            
  data.map(item => {
      let itm = {menuitemId:item.id,quantity:item.quantity}
      selectedItems.push(itm)
  })
  console.log(selectedItems)

  let body={
            items: selectedItems,
            total: grandTotal,
            gst: gst,
            deliveryCharges: delCharge,
            userId: 2,
            restaurantId: restaurantId
  }


    if(selectedPaymentMode===undefined || selectedAddress===undefined){
      openModal("error", "All fields are required")
    }else{
      if(selectedPaymentMode==="cod"){
          axios.post(`${baseUrl}/createOrder`,body).then((order)=>{
          console.log(order.data.orderDetails)
          orderDetails = order.data.orderDetails
              openModal("success", "Order placed")
      
          }).catch((err)=>{
            console.log(err)
          })
      }else{
          axios.post(`${baseUrl}/createOrder`,body).then((order)=>{
          console.log(order.data.orderDetails)
          orderDetails = order.data.orderDetails
          axios.post(`${baseUrl}/payment/order?totalPrice=${orderDetails.total}`).then((res)=>{
            console.log(res)

            let options = {
                  "key": "rzp_test_uYURsxfax869Qb",
                  //"key": "rzp_test_sfVXbRhBv56ltm",
                  "amount": res.data.data.amount,
                  "currency": res.data.data.currency,
                  "name": "Acme Corp",
                  "description": "Test Transaction",
                  "image": "https://example.com/your_logo",
                  "order_id": res.data.data.id,
                  "handler": function (response){
                    axios.post(`${baseUrl}/isordercomplete?orderId=${orderDetails.orderId}`,response).then(res=>{
                        // console.log(res.data.message);
                          if(res.data.message==="success"){
                              cartLS.destroy()
                              openModal("success", "Thank you for your payment", closePaymentModal)
                          }else{
                              openModal("error", "Oh no, your payment failed")
                          }
                        })
                  },
                    "theme": {
                        "color": "#3399cc"
                  }
            };

            var rzp1 = new Razorpay(options);
                rzp1.on('payment.failed', function (response){
                //window.location = `${baseUrl}/paymentfailure`;
                openModal("error", "Oh no, your payment failed")
            });

          function payNow(){
                rzp1.open();
                //e.preventDefault();
          }
          payNow()
    })
          }).catch((err)=>{
            console.log(err)
          })
      }
      
    }
}

function renderCart(items) {
        let {gst, delCharge, totalItemPrice, discount, discountedPrice, gstValue, grandTotal} = calculateAmounts()

        //const $cart = document.querySelector(".cart")
        //const $total = document.querySelector(".total")
        const $cart = document.querySelector("#order-items")
        const $total = document.querySelector("#cart-subtotal")
        const $heading = document.querySelector("#cart-toggler-heading")
        const $checkoutItems = document.querySelector("#checkout-items")
        const $checkoutTotal = document.querySelector("#checkout-total")
        const $discount = document.querySelector("#discount")
        const $gst = document.querySelector("#gst")
        const $delivery = document.querySelector("#delivery")
        const $grandtotal = document.querySelector("#grandtotal")

// $cart.innerHTML = items.map((item) => `
            //  <tr>
            //      <td>#${item.id}</td>
            //      <td>${item.name}</td>
             //     <td>${item.quantity}</td>
             //     <td style="width: 60px;">
             //         <button type="button" class="btn btn-block btn-sm btn-outline-success" style="font-size:14px; font-weight:600;" onClick="cartLS.quantity(${item.id},1)">+</button>
              //    </td>
              //    <td style="width: 60px;">
                //      <button type="button" class="btn btn-block btn-sm btn-outline-success" style="font-size:14px; font-weight:600;" onClick="cartLS.quantity(${item.id},-1)">-</button>
                //  </td>
                //  <td class="text-right">&#8377; ${item.price}</td>
                //  <td class="text-right"><Button class="btn btn-outline-danger" onClick="cartLS.remove(${item.id})">Delete</Button></td>
             // </tr>`).join("")

     // $total.innerHTML = "&#8377; " + cartLS.total()

 $cart.innerHTML = items.map((item) => `<div class="order-item">
                                    <div class="item-name">${item.name}</div>
                                    <div class="quantity-price">
                                        <div class="quantity">
                                            <div>
                                                <i class="fa fa-minus"  onClick="cartLS.quantity(${item.id},-1)"></i>
                                            </div>
                                            <div>${item.quantity}</div>
                                            <div>
                                                <i class="fa fa-plus" onClick="cartLS.quantity(${item.id},1)"></i>
                                            </div>
                                        </div>
                                        <div class="price">&#8377; ${item.price * item.quantity}</div>
                                        <div><i class="fa fa-trash-o" onClick="cartLS.remove(${item.id})"></i></div>
                                    </div>
                              </div>`).join("")

    $total.innerHTML = "Subtotal:  &#8377;" + cartLS.total()

    $checkoutItems.innerHTML = items.map((item)=>`<div class="order-itm">
                                  <div class="order-item-name">
                                      <p class="name">${item.name}</p>
                                      <p class="price">&#8377; ${item.price * item.quantity}</p>
                                  </div>
                                  <div class="order-btn">
                                    <div class="quantity">
                                        <div>
                                            <i class="fa fa-minus"  onClick="cartLS.quantity(${item.id},-1)"></i>
                                        </div>
                                        <div>${item.quantity}</div>
                                        <div>
                                            <i class="fa fa-plus" onClick="cartLS.quantity(${item.id},1)"></i>
                                        </div>
                                    </div>
                                  </div>
                                </div>`).join("")

    $checkoutTotal.innerHTML = "&#8377;" + cartLS.total()

    $discount.innerHTML="- &#8377;"+discount
    $gst.innerHTML="&#8377;"+gstValue
    $delivery.innerHTML="&#8377;"+delCharge
    $grandtotal.innerHTML="&#8377;"+grandTotal

    let totalItems = 0
    $heading.innerHTML = items.map((item)=>{
       return totalItems+=item.quantity
    })
    $heading.innerHTML = `Your order (${totalItems})`

    console.log(items.length)
    if(items.length<=0){
      $("#order-content").removeClass("active")
      $("#clear-cart").removeClass("active")
      $("#cart-toggler").css("display","none")
    }else{
      $("#cart-toggler").css("display","block")
    }
}

renderCart(cartLS.list())
cartLS.onChange(renderCart)


// Review submit button
  document.getElementById('btn-submit').onclick = function(e){
      e.preventDefault();
      const form = document.getElementById('feedback');
                
      // getting the element's value
      const stars = form.elements['rate'].value;
      const comment = form.elements['review'].value;

      const data = {
        stars : parseInt(stars),
        comment : comment
      }

      axios.post(`${baseUrl}/addnewreview?userId=2&restaurantId=${restaurantId}`,data).then(res => {
          console.log(res)
          alert("Your Review has been successfully submitted.");
      }).catch(err => {
          alert(err.response.data.error)
      })
}


// Order button/continue
/*document.getElementById('').onclick = function(e){
      e.preventDefault();
                
      let data = JSON.parse(localStorage.getItem('__cart'))
      console.log(data)

      let items = []
            
      data.map(item => {
      let itm = {menuitemId:item.id,quantity:item.quantity}
        items.push(itm)
      })
      console.log(items)
   
      if(items.length > 0){
            axios.post(`${baseUrl}/api/v1/order?userId=2&restaurantId=${restaurantId}`,{items},).then(res => {
                console.log(res)
                let totalPrice = res.data.orderDetails.total;
                localStorage.setItem('updatedTotal',totalPrice)
                  //console.log(totalPrice)
                let orderId = res.data.orderDetails.orderId;
                  //console.log(orderId)
                let gst = res.data.orderDetails.gst;
                  //console.log(gst)
                let deliveryCharges = res.data.orderDetails.deliveryCharges;
                let subtotal = totalPrice - gst - deliveryCharges ;
                  //console.log(subtotal)
                if(res){
                  let url = `${baseUrl}/api/v1/payment/checkout?userId=2&orderId=${orderId}&totalPrice=${totalPrice}&gst=${gst}&subtotal=${subtotal}&deliveryCharges=${deliveryCharges}&restaurantId=${restaurantId}`;
                  window.location = url;
                }
            }).catch(err => {
                  console.log(err.response.data);
            })}else{
                  alert('Please Select food items to proceed')
            }
}*/

function openCity(evt, cityName) {
    var i, tabcontent, tablinks;
    tabcontent = document.getElementsByClassName("tabcontent");
    for (i = 0; i < tabcontent.length; i++) {
        tabcontent[i].style.display = "none";
    }
    tablinks = document.getElementsByClassName("tablinks");
    for (i = 0; i < tablinks.length; i++) {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
    }
    document.getElementById(cityName).style.display = "block";
    evt.currentTarget.className += " active";
}

// Carousel
var swiper = new Swiper(".mySwiper", {
        loop: true,
        spaceBetween: 10,
        slidesPerView: 6,
        freeMode: true,
        watchSlidesProgress: true,
        });
      var swiper2 = new Swiper(".mySwiper2", {
        loop: true,
        spaceBetween: 10,
        // autoplay: {
        //   delay: 2500,
        //   disableOnInteraction: false,
        // },
        navigation: {
        nextEl: ".swiper-button-next",
        prevEl: ".swiper-button-prev",
        },
        thumbs: {
        swiper: swiper,
        },
});


</script>
  </body>
</html>
